---
id: 20260225120000
title: "Qwen3-Reranker-8B"
status: active
source: ai-research
tags: [ai/reranker, ai/model-card, ai/rag]
type: note
summary: "Карточка reranker-модели Qwen3-Reranker-8B (Alibaba/Qwen): 8B параметров, cross-encoder reranker, повышает P@5 с 0.93 до 0.96"
ai_weight: high
created: 2026-02-25
updated: 2026-02-25
---
# Qwen3-Reranker-8B

## Что такое Reranker (простым языком)

Embedding-поиск работает быстро, но неточно: он считает приблизительное расстояние между векторами. Reranker работает иначе - он берёт каждый кандидат из первичного поиска и читает его вместе с запросом целиком (cross-encoder), выдавая точный score релевантности.

```
Запрос -> Qdrant (top-50 по векторам) -> Reranker -> top-5 самых точных
```

Это медленнее, но даёт значительно лучшее качество финального ранжирования.

## Основные характеристики

| Параметр | Значение |
|----------|----------|
| Разработчик | Alibaba / Qwen |
| Параметры | 8B |
| Тип | Cross-encoder reranker |
| Лицензия | Apache-2.0 |
| Мультиязычность | 100+ языков |
| Архитектура | Decoder-only с специализацией на reranking |
| Нативный формат | Нативный API DeepInfra (queries + scores) |

## Провайдеры

| Провайдер | Endpoint | Цена за 1M tok | Формат ответа | Статус |
|-----------|----------|:--------------:|---------------|--------|
| DeepInfra | `https://api.deepinfra.com/v1/inference/Qwen/Qwen3-Reranker-8B` | $0.05 | Нативный: `{"scores": [...]}` | **АКТИВНЫЙ (с 2026-02-25)** |
| Fireworks AI | `https://api.fireworks.ai/inference/v1/rerank` | $0.10 | Стандартный: `{"data": [{index, relevance_score}]}` | **РЕЗЕРВ (с 2026-02-25)** |

## Разница форматов DeepInfra vs Fireworks

### DeepInfra (нативный API)

Endpoint: `/v1/inference/Qwen/Qwen3-Reranker-8B`

Запрос:
```json
{
  "queries": ["запрос пользователя"],
  "passages": [
    "текст кандидата 1",
    "текст кандидата 2"
  ]
}
```

Ответ:
```json
{
  "scores": [0.87, 0.43]
}
```

Индексы scores совпадают с индексами passages напрямую.

### Fireworks AI (стандартный формат /v1/rerank)

Endpoint: `/v1/rerank`

Запрос:
```json
{
  "model": "accounts/fireworks/models/qwen3-reranker-8b",
  "query": "запрос пользователя",
  "documents": [
    "текст кандидата 1",
    "текст кандидата 2"
  ]
}
```

Ответ:
```json
{
  "data": [
    {"index": 0, "relevance_score": 0.87},
    {"index": 1, "relevance_score": 0.43}
  ]
}
```

### Автодетект формата в mcp-kb-server.py

`mcp-kb-server.py` определяет провайдера по URL (`deepinfra.com` vs `fireworks.ai`) и вызывает соответствующий парсер ответа. При смене провайдера достаточно изменить переменную окружения `RERANKER_URL`.

## Применение

| Скрипт | Функция |
|--------|---------|
| `mcp-kb-server.py` | RAG поиск KB компании: reranking кандидатов из Qdrant, автодетект формата по URL |
| `kb-indexer.py` | Индексация не использует reranker (только embedding) |

## Бенчмарк (результаты компании)

| Phase | Конфигурация | P@5 |
|-------|-------------|:---:|
| Phase 1 (baseline) | Qdrant cosine search, HNSW ef=128 | 0.74 |
| Phase 2 | Multi-query expansion + RRF (k=60), HNSW ef=256 | 0.93 |
| Phase 3 | Phase 2 + Qwen3-Reranker-8B | **0.96** |

Прирост от reranker: **+3 п.п.** (с 0.93 до 0.96). Latency ~1.2s на запрос (6.75x быстрее baseline).

## Конфигурация (env vars)

```bash
RERANKER_URL=https://api.deepinfra.com/v1/inference/Qwen/Qwen3-Reranker-8B
RERANKER_API_KEY=<deepinfra_key>
# Для Fireworks fallback:
# RERANKER_URL=https://api.fireworks.ai/inference/v1/rerank
# RERANKER_API_KEY=<fireworks_key>
```

## Сравнение с конкурентами

| Модель | Параметры | Провайдер | Цена (1M) | P@5 (наш тест) |
|--------|:---------:|-----------|:---------:|:--------------:|
| **Qwen3-Reranker-8B** | 8B | DeepInfra | $0.05 | **0.96** |
| Qwen3-Reranker-8B | 8B | Fireworks AI | $0.10 | 0.96 (те же модели) |
| BGE-Reranker-v2-m3 | 568M | локально | $0 | ~0.90 (оценка) |

## Links (internal)

- [[infra_all_instruments/docs/neural-networks/by-type/embedding__20260210220400-10|Embedding модели (индекс)]]
- [[infra_all_instruments/docs/neural-networks/cards/qwen3-embedding-8b__20260220190000|Qwen3-Embedding-8B (карточка)]]
- [[infra_all_instruments/docs/neural-networks/cards/bge-m3__20260218190000-04|BGE-M3 (карточка)]]
